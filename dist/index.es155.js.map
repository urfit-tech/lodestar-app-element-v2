{"version":3,"file":"index.es155.js","sources":["../../node_modules/@wry/trie/lib/index.js"],"sourcesContent":["// A [trie](https://en.wikipedia.org/wiki/Trie) data structure that holds\n// object keys weakly, yet can also hold non-object keys, unlike the\n// native `WeakMap`.\n// If no makeData function is supplied, the looked-up data will be an empty,\n// null-prototype Object.\nconst defaultMakeData = () => Object.create(null);\n// Useful for processing arguments objects as well as arrays.\nconst { forEach, slice } = Array.prototype;\nconst { hasOwnProperty } = Object.prototype;\nexport class Trie {\n    constructor(weakness = true, makeData = defaultMakeData) {\n        this.weakness = weakness;\n        this.makeData = makeData;\n    }\n    lookup() {\n        return this.lookupArray(arguments);\n    }\n    lookupArray(array) {\n        let node = this;\n        forEach.call(array, key => node = node.getChildTrie(key));\n        return hasOwnProperty.call(node, \"data\")\n            ? node.data\n            : node.data = this.makeData(slice.call(array));\n    }\n    peek() {\n        return this.peekArray(arguments);\n    }\n    peekArray(array) {\n        let node = this;\n        for (let i = 0, len = array.length; node && i < len; ++i) {\n            const map = node.mapFor(array[i], false);\n            node = map && map.get(array[i]);\n        }\n        return node && node.data;\n    }\n    remove() {\n        return this.removeArray(arguments);\n    }\n    removeArray(array) {\n        let data;\n        if (array.length) {\n            const head = array[0];\n            const map = this.mapFor(head, false);\n            const child = map && map.get(head);\n            if (child) {\n                data = child.removeArray(slice.call(array, 1));\n                if (!child.data && !child.weak && !(child.strong && child.strong.size)) {\n                    map.delete(head);\n                }\n            }\n        }\n        else {\n            data = this.data;\n            delete this.data;\n        }\n        return data;\n    }\n    getChildTrie(key) {\n        const map = this.mapFor(key, true);\n        let child = map.get(key);\n        if (!child)\n            map.set(key, child = new Trie(this.weakness, this.makeData));\n        return child;\n    }\n    mapFor(key, create) {\n        return this.weakness && isObjRef(key)\n            ? this.weak || (create ? this.weak = new WeakMap : void 0)\n            : this.strong || (create ? this.strong = new Map : void 0);\n    }\n}\nfunction isObjRef(value) {\n    switch (typeof value) {\n        case \"object\":\n            if (value === null)\n                break;\n        // Fall through to return true...\n        case \"function\":\n            return true;\n    }\n    return false;\n}\n//# sourceMappingURL=index.js.map"],"names":["defaultMakeData","forEach","slice","hasOwnProperty","Trie","weakness","makeData","array","node","key","i","len","map","data","head","child","create","isObjRef","value"],"mappings":"AAKA,MAAMA,IAAkB,MAAM,uBAAO,OAAO,IAAI,GAE1C,EAAE,SAAAC,GAAS,OAAAC,MAAU,MAAM,WAC3B,EAAE,gBAAAC,EAAc,IAAK,OAAO;AAC3B,MAAMC,EAAK;AAAA,EACd,YAAYC,IAAW,IAAMC,IAAWN,GAAiB;AACrD,SAAK,WAAWK,GAChB,KAAK,WAAWC;AAAA,EACxB;AAAA,EACI,SAAS;AACL,WAAO,KAAK,YAAY,SAAS;AAAA,EACzC;AAAA,EACI,YAAYC,GAAO;AACf,QAAIC,IAAO;AACX,WAAAP,EAAQ,KAAKM,GAAO,CAAAE,MAAOD,IAAOA,EAAK,aAAaC,CAAG,CAAC,GACjDN,EAAe,KAAKK,GAAM,MAAM,IACjCA,EAAK,OACLA,EAAK,OAAO,KAAK,SAASN,EAAM,KAAKK,CAAK,CAAC;AAAA,EACzD;AAAA,EACI,OAAO;AACH,WAAO,KAAK,UAAU,SAAS;AAAA,EACvC;AAAA,EACI,UAAUA,GAAO;AACb,QAAIC,IAAO;AACX,aAASE,IAAI,GAAGC,IAAMJ,EAAM,QAAQC,KAAQE,IAAIC,GAAK,EAAED,GAAG;AACtD,YAAME,IAAMJ,EAAK,OAAOD,EAAMG,CAAC,GAAG,EAAK;AACvC,MAAAF,IAAOI,KAAOA,EAAI,IAAIL,EAAMG,CAAC,CAAC;AAAA,IAC1C;AACQ,WAAOF,KAAQA,EAAK;AAAA,EAC5B;AAAA,EACI,SAAS;AACL,WAAO,KAAK,YAAY,SAAS;AAAA,EACzC;AAAA,EACI,YAAYD,GAAO;AACf,QAAIM;AACJ,QAAIN,EAAM,QAAQ;AACd,YAAMO,IAAOP,EAAM,CAAC,GACdK,IAAM,KAAK,OAAOE,GAAM,EAAK,GAC7BC,IAAQH,KAAOA,EAAI,IAAIE,CAAI;AACjC,MAAIC,MACAF,IAAOE,EAAM,YAAYb,EAAM,KAAKK,GAAO,CAAC,CAAC,GACzC,CAACQ,EAAM,QAAQ,CAACA,EAAM,QAAQ,EAAEA,EAAM,UAAUA,EAAM,OAAO,SAC7DH,EAAI,OAAOE,CAAI;AAAA,IAGnC;AAEY,MAAAD,IAAO,KAAK,MACZ,OAAO,KAAK;AAEhB,WAAOA;AAAA,EACf;AAAA,EACI,aAAaJ,GAAK;AACd,UAAMG,IAAM,KAAK,OAAOH,GAAK,EAAI;AACjC,QAAIM,IAAQH,EAAI,IAAIH,CAAG;AACvB,WAAKM,KACDH,EAAI,IAAIH,GAAKM,IAAQ,IAAIX,EAAK,KAAK,UAAU,KAAK,QAAQ,CAAC,GACxDW;AAAA,EACf;AAAA,EACI,OAAON,GAAKO,GAAQ;AAChB,WAAO,KAAK,YAAYC,EAASR,CAAG,IAC9B,KAAK,SAASO,IAAS,KAAK,OAAO,oBAAI,YAAU,UACjD,KAAK,WAAWA,IAAS,KAAK,SAAS,oBAAI,QAAM;AAAA,EAC/D;AACA;AACA,SAASC,EAASC,GAAO;AACrB,UAAQ,OAAOA,GAAK;AAAA,IAChB,KAAK;AACD,UAAIA,MAAU;AACV;AAAA;AAAA,IAER,KAAK;AACD,aAAO;AAAA,EACnB;AACI,SAAO;AACX;","x_google_ignoreList":[0]}