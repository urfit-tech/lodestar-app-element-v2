"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const G=require("./index.cjs233.js"),B=require("./index.cjs202.js"),M=require("./index.cjs71.js"),O=require("./index.cjs234.js"),x=require("./index.cjs206.js");var _,b;function C(){if(b)return _;b=1;var w=G.__require(),u=B.__require().Buffer,a=M.default,y=O.__require(),d=x.__require(),R=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,s="secret must be a string or buffer",c="key must be a string or a buffer",h="key must be a string, a buffer or an object",p=typeof a.createPublicKey=="function";p&&(c+=" or a KeyObject",s+="or a KeyObject");function l(r){if(!u.isBuffer(r)&&typeof r!="string"&&(!p||typeof r!="object"||typeof r.type!="string"||typeof r.asymmetricKeyType!="string"||typeof r.export!="function"))throw f(c)}function m(r){if(!u.isBuffer(r)&&typeof r!="string"&&typeof r!="object")throw f(h)}function q(r){if(!u.isBuffer(r)){if(typeof r=="string")return r;if(!p||typeof r!="object"||r.type!=="secret"||typeof r.export!="function")throw f(s)}}function g(r){return r.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function E(r){r=r.toString();var i=4-r.length%4;if(i!==4)for(var e=0;e<i;++e)r+="=";return r.replace(/\-/g,"+").replace(/_/g,"/")}function f(r){var i=[].slice.call(arguments,1),e=d.format.bind(d,r).apply(null,i);return new TypeError(e)}function D(r){return u.isBuffer(r)||typeof r=="string"}function S(r){return D(r)||(r=JSON.stringify(r)),r}function A(r){return function(e,t){q(t),e=S(e);var n=a.createHmac("sha"+r,t),o=(n.update(e),n.digest("base64"));return g(o)}}function H(r){return function(e,t,n){var o=A(r)(e,n);return w(u.from(t),u.from(o))}}function I(r){return function(e,t){m(t),e=S(e);var n=a.createSign("RSA-SHA"+r),o=(n.update(e),n.sign(t,"base64"));return g(o)}}function P(r){return function(e,t,n){l(n),e=S(e),t=E(t);var o=a.createVerify("RSA-SHA"+r);return o.update(e),o.verify(n,t,"base64")}}function K(r){return function(e,t){m(t),e=S(e);var n=a.createSign("RSA-SHA"+r),o=(n.update(e),n.sign({key:t,padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return g(o)}}function L(r){return function(e,t,n){l(n),e=S(e),t=E(t);var o=a.createVerify("RSA-SHA"+r);return o.update(e),o.verify({key:n,padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},t,"base64")}}function N(r){var i=I(r);return function(){var t=i.apply(null,arguments);return t=y.derToJose(t,"ES"+r),t}}function V(r){var i=P(r);return function(t,n,o){n=y.joseToDer(n,"ES"+r).toString("base64");var v=i(t,n,o);return v}}function j(){return function(){return""}}function T(){return function(i,e){return e===""}}return _=function(i){var e={hs:A,rs:I,ps:K,es:N,none:j},t={hs:H,rs:P,ps:L,es:V,none:T},n=i.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!n)throw f(R,i);var o=(n[1]||n[3]).toLowerCase(),v=n[2];return{sign:e[o](v),verify:t[o](v)}},_}exports.__require=C;
//# sourceMappingURL=index.cjs204.js.map
