"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const b=require("./index.cjs202.js"),q=require("./index.cjs203.js"),p=require("./index.cjs204.js"),w=require("./index.cjs71.js"),j=require("./index.cjs205.js"),x=require("./index.cjs206.js");var c,f;function K(){if(f)return c;f=1;var v=b.__require().Buffer,o=q.__require(),g=p.__require(),y=w.default,u=j.__require(),a=x.__require();function d(e,r){return v.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function m(e,r,t){t=t||"utf8";var n=d(u(e),"binary"),s=d(u(r),t);return a.format("%s.%s",n,s)}function h(e){var r=e.header,t=e.payload,n=e.secret||e.privateKey,s=e.encoding,S=g(r.alg),l=m(r,t,s),_=S.sign(l,n);return a.format("%s.%s",l,_)}function i(e){var r=e.secret||e.privateKey||e.key,t=new o(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new o(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}return a.inherits(i,y),i.prototype.sign=function(){try{var r=h({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",r),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}},i.sign=h,c=i,c}exports.__require=K;
//# sourceMappingURL=index.cjs126.js.map
