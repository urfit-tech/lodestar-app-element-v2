"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const v=require("./index.cjs149.js"),r=require("./index.cjs99.js"),p=require("./index.cjs110.js"),U=require("./index.cjs219.js"),L=require("./index.cjs220.js"),k=require("./index.cjs113.js"),d=require("./index.cjs217.js"),H=require("./index.cjs218.js"),K=require("./index.cjs215.js"),R=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",O=R&&typeof ReadableStream=="function",j=R&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),A=(e,...t)=>{try{return!!e(...t)}catch{return!1}},z=O&&A(()=>{let e=!1;const t=new Request(v.default.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),_=64*1024,T=O&&A(()=>r.default.isReadableStream(new Response("").body)),w={stream:T&&(e=>e.body)};R&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!w[t]&&(w[t]=r.default.isFunction(e[t])?s=>s[t]():(s,i)=>{throw new p.default(`Response type '${t}' is not supported`,p.default.ERR_NOT_SUPPORT,i)})})})(new Response);const M=async e=>{if(e==null)return 0;if(r.default.isBlob(e))return e.size;if(r.default.isSpecCompliantForm(e))return(await new Request(v.default.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(r.default.isArrayBufferView(e)||r.default.isArrayBuffer(e))return e.byteLength;if(r.default.isURLSearchParams(e)&&(e=e+""),r.default.isString(e))return(await j(e)).byteLength},I=async(e,t)=>{const s=r.default.toFiniteNumber(e.getContentLength());return s??M(t)},J=R&&(async e=>{let{url:t,method:s,data:i,signal:D,cancelToken:b,timeout:B,onDownloadProgress:S,onUploadProgress:x,responseType:o,headers:y,withCredentials:h="same-origin",fetchOptions:F}=H.default(e);o=o?(o+"").toLowerCase():"text";let m=U.default([D,b&&b.toAbortSignal()],B),f;const c=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let E;try{if(x&&z&&s!=="get"&&s!=="head"&&(E=await I(y,i))!==0){let u=new Request(t,{method:"POST",body:i,duplex:"half"}),l;if(r.default.isFormData(i)&&(l=u.headers.get("content-type"))&&y.setContentType(l),u.body){const[q,g]=d.progressEventDecorator(E,d.progressEventReducer(d.asyncDecorator(x)));i=L.trackStream(u.body,_,q,g)}}r.default.isString(h)||(h=h?"include":"omit");const n="credentials"in Request.prototype;f=new Request(t,{...F,signal:m,method:s.toUpperCase(),headers:y.normalize().toJSON(),body:i,duplex:"half",credentials:n?h:void 0});let a=await fetch(f);const C=T&&(o==="stream"||o==="response");if(T&&(S||C&&c)){const u={};["status","statusText","headers"].forEach(P=>{u[P]=a[P]});const l=r.default.toFiniteNumber(a.headers.get("content-length")),[q,g]=S&&d.progressEventDecorator(l,d.progressEventReducer(d.asyncDecorator(S),!0))||[];a=new Response(L.trackStream(a.body,_,q,()=>{g&&g(),c&&c()}),u)}o=o||"text";let N=await w[r.default.findKey(w,o)||"text"](a,e);return!C&&c&&c(),await new Promise((u,l)=>{K.default(u,l,{data:N,headers:k.default.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:f})})}catch(n){throw c&&c(),n&&n.name==="TypeError"&&/fetch/i.test(n.message)?Object.assign(new p.default("Network Error",p.default.ERR_NETWORK,e,f),{cause:n.cause||n}):p.default.from(n,n&&n.code,e,f)}});exports.default=J;
//# sourceMappingURL=index.cjs153.js.map
