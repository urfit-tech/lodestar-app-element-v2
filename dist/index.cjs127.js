"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const W=require("./index.cjs202.js"),I=require("./index.cjs203.js"),j=require("./index.cjs204.js"),w=require("./index.cjs71.js"),x=require("./index.cjs205.js"),A=require("./index.cjs206.js");var n,y;function E(){if(y)return n;y=1;var u=W.__require().Buffer,s=I.__require(),v=j.__require(),m=w.default,o=x.__require(),b=A.__require(),_=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function S(e){return Object.prototype.toString.call(e)==="[object Object]"}function q(e){if(S(e))return e;try{return JSON.parse(e)}catch{return}}function f(e){var r=e.split(".",1)[0];return q(u.from(r,"base64").toString("binary"))}function g(e){return e.split(".",2).join(".")}function c(e){return e.split(".")[2]}function p(e,r){r=r||"utf8";var t=e.split(".")[1];return u.from(t,"base64").toString(r)}function l(e){return _.test(e)&&!!f(e)}function h(e,r,t){if(!r){var i=new Error("Missing algorithm parameter for jws.verify");throw i.code="MISSING_ALGORITHM",i}e=o(e);var J=c(e),O=g(e),V=v(r);return V.verify(O,J,t)}function d(e,r){if(r=r||{},e=o(e),!l(e))return null;var t=f(e);if(!t)return null;var i=p(e);return(t.typ==="JWT"||r.json)&&(i=JSON.parse(i,r.encoding)),{header:t,payload:i,signature:c(e)}}function a(e){e=e||{};var r=e.secret||e.publicKey||e.key,t=new s(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new s(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}return b.inherits(a,m),a.prototype.verify=function(){try{var r=h(this.signature.buffer,this.algorithm,this.key.buffer),t=d(this.signature.buffer,this.encoding);return this.emit("done",r,t),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(i){this.readable=!1,this.emit("error",i),this.emit("close")}},a.decode=d,a.isValid=l,a.verify=h,n=a,n}exports.__require=E;
//# sourceMappingURL=index.cjs127.js.map
