{"version":3,"file":"index.es278.js","sources":["../../node_modules/@wry/caches/lib/strong.js"],"sourcesContent":["function defaultDispose() { }\nexport class StrongCache {\n    constructor(max = Infinity, dispose = defaultDispose) {\n        this.max = max;\n        this.dispose = dispose;\n        this.map = new Map();\n        this.newest = null;\n        this.oldest = null;\n    }\n    has(key) {\n        return this.map.has(key);\n    }\n    get(key) {\n        const node = this.getNode(key);\n        return node && node.value;\n    }\n    get size() {\n        return this.map.size;\n    }\n    getNode(key) {\n        const node = this.map.get(key);\n        if (node && node !== this.newest) {\n            const { older, newer } = node;\n            if (newer) {\n                newer.older = older;\n            }\n            if (older) {\n                older.newer = newer;\n            }\n            node.older = this.newest;\n            node.older.newer = node;\n            node.newer = null;\n            this.newest = node;\n            if (node === this.oldest) {\n                this.oldest = newer;\n            }\n        }\n        return node;\n    }\n    set(key, value) {\n        let node = this.getNode(key);\n        if (node) {\n            return node.value = value;\n        }\n        node = {\n            key,\n            value,\n            newer: null,\n            older: this.newest\n        };\n        if (this.newest) {\n            this.newest.newer = node;\n        }\n        this.newest = node;\n        this.oldest = this.oldest || node;\n        this.map.set(key, node);\n        return node.value;\n    }\n    clean() {\n        while (this.oldest && this.map.size > this.max) {\n            this.delete(this.oldest.key);\n        }\n    }\n    delete(key) {\n        const node = this.map.get(key);\n        if (node) {\n            if (node === this.newest) {\n                this.newest = node.older;\n            }\n            if (node === this.oldest) {\n                this.oldest = node.newer;\n            }\n            if (node.newer) {\n                node.newer.older = node.older;\n            }\n            if (node.older) {\n                node.older.newer = node.newer;\n            }\n            this.map.delete(key);\n            this.dispose(node.value, key);\n            return true;\n        }\n        return false;\n    }\n}\n//# sourceMappingURL=strong.js.map"],"names":["defaultDispose","StrongCache","max","dispose","key","node","older","newer","value"],"mappings":"AAAA,SAASA,IAAiB;AAAA;AACnB,MAAMC,EAAY;AAAA,EACrB,YAAYC,IAAM,OAAUC,IAAUH,GAAgB;AAClD,SAAK,MAAME,GACX,KAAK,UAAUC,GACf,KAAK,MAAM,oBAAI,IAAK,GACpB,KAAK,SAAS,MACd,KAAK,SAAS;AAAA,EACtB;AAAA,EACI,IAAIC,GAAK;AACL,WAAO,KAAK,IAAI,IAAIA,CAAG;AAAA,EAC/B;AAAA,EACI,IAAIA,GAAK;AACL,UAAMC,IAAO,KAAK,QAAQD,CAAG;AAC7B,WAAOC,KAAQA,EAAK;AAAA,EAC5B;AAAA,EACI,IAAI,OAAO;AACP,WAAO,KAAK,IAAI;AAAA,EACxB;AAAA,EACI,QAAQD,GAAK;AACT,UAAMC,IAAO,KAAK,IAAI,IAAID,CAAG;AAC7B,QAAIC,KAAQA,MAAS,KAAK,QAAQ;AAC9B,YAAM,EAAE,OAAAC,GAAO,OAAAC,EAAK,IAAKF;AACzB,MAAIE,MACAA,EAAM,QAAQD,IAEdA,MACAA,EAAM,QAAQC,IAElBF,EAAK,QAAQ,KAAK,QAClBA,EAAK,MAAM,QAAQA,GACnBA,EAAK,QAAQ,MACb,KAAK,SAASA,GACVA,MAAS,KAAK,WACd,KAAK,SAASE;AAAA,IAE9B;AACQ,WAAOF;AAAA,EACf;AAAA,EACI,IAAID,GAAKI,GAAO;AACZ,QAAIH,IAAO,KAAK,QAAQD,CAAG;AAC3B,WAAIC,IACOA,EAAK,QAAQG,KAExBH,IAAO;AAAA,MACH,KAAAD;AAAA,MACA,OAAAI;AAAA,MACA,OAAO;AAAA,MACP,OAAO,KAAK;AAAA,IACf,GACG,KAAK,WACL,KAAK,OAAO,QAAQH,IAExB,KAAK,SAASA,GACd,KAAK,SAAS,KAAK,UAAUA,GAC7B,KAAK,IAAI,IAAID,GAAKC,CAAI,GACfA,EAAK;AAAA,EACpB;AAAA,EACI,QAAQ;AACJ,WAAO,KAAK,UAAU,KAAK,IAAI,OAAO,KAAK;AACvC,WAAK,OAAO,KAAK,OAAO,GAAG;AAAA,EAEvC;AAAA,EACI,OAAOD,GAAK;AACR,UAAMC,IAAO,KAAK,IAAI,IAAID,CAAG;AAC7B,WAAIC,KACIA,MAAS,KAAK,WACd,KAAK,SAASA,EAAK,QAEnBA,MAAS,KAAK,WACd,KAAK,SAASA,EAAK,QAEnBA,EAAK,UACLA,EAAK,MAAM,QAAQA,EAAK,QAExBA,EAAK,UACLA,EAAK,MAAM,QAAQA,EAAK,QAE5B,KAAK,IAAI,OAAOD,CAAG,GACnB,KAAK,QAAQC,EAAK,OAAOD,CAAG,GACrB,MAEJ;AAAA,EACf;AACA;","x_google_ignoreList":[0]}